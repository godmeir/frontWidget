function getQueryStringByName(e){var t=decodeURI(location.href),a=t.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==a||a.length<1?"":a[1]}function parseUrlData(){FastClick.attach(document.body),g_mac=getQueryStringByName("mac"),g_functype=getQueryStringByName("functype"),data=getQueryStringByName("data"),IsDebug?setTimeout(loadTestData,500):setTimeout(loadData,500)}function loadData(){navigator.PluginInterface.getInfo(g_mac,loadDataFinish)}function loadDataFinish(e){try{deviceInfo=JSON.parse(e),g_CurrentLang=deviceInfo.lang,path=deviceInfo.path,searchJson=deviceInfo.fullstatueJson,console.log("data:"+data),""!=data&&"null"!=data||(data='[1.0,0.0,1.0,1000.0,40.0,1.0,87.0,87.0,1.0,1.0,1.0,1.0,15.0,2.0,1.0,1.0,1.0,1.0,-1.0,1.0,0.0,[],"洗干一体机"]'),0==deviceInfo.lock?$("#modeLock").hide():$("#modeLock").show(),"zh_CN"==deviceInfo.lang?$.getScript("./js/lang/zh_CN.js",function(){init(data),setTimeout(function(){$("#loading").hide()},100)}):$.getScript("./js/lang/en.js",function(){init(data),setTimeout(function(){$("#loading").hide()},100)})}catch(e){console.log(e)}}function loadTestData(){""!=data&&"null"!=data||(data='[1.0,0.0,1.0,1000.0,40.0,1.0,87.0,87.0,1.0,1.0,1.0,1.0,15.0,2.0,1.0,1.0,1.0,1.0,-1.0,1.0,0.0,[],"洗干一体机"]'),$.getScript("./js/lang/zh_CN.js",function(){try{deviceInfo={},deviceInfo.lang="zh_CN",g_CurrentLang=deviceInfo.lang,init(data)}catch(e){console.log(e)}}),setTimeout(function(){$("#loading").hide()},100)}function parseStates(e){if(""!=e)try{var t=JSON.parse(e);DataObject.power=parseInt(t[0]),DataObject.runState=parseInt(t[1]),DataObject.washMode=parseInt(t[2]),DataObject.speed=parseInt(t[3]),DataObject.washTemp=parseInt(t[4]),DataObject.stage=parseInt(t[5]),DataObject.timeLeft=parseInt(t[6]),DataObject.timeAll=parseInt(t[7]),DataObject.energySave=parseInt(t[8]),DataObject.preWash=parseInt(t[9]),DataObject.creaseRes=parseInt(t[10]),DataObject.noDrain=parseInt(t[11]),DataObject.adjustWash=parseInt(t[12]),DataObject.potch=parseInt(t[13]),DataObject.nightWash=parseInt(t[14]),DataObject.highWater=parseInt(t[15]),DataObject.order=parseInt(t[16]),DataObject.dryMode=parseInt(t[17]),DataObject.childLock=parseInt(t[18]),DataObject.quiet=parseInt(t[19]),DataObject.noFoam=parseInt(t[20]);var a=[];a=t[21],DataObject.er=[];for(var o=0;o<a.length;o++)DataObject.er.push(parseInt(a[o]));DataObject.name=t[22]}catch(e){console.log(e)}}function init(e){IsDebug&&(voiceManager=new voiceWidget(changCallback)),null==uiMethodObj&&(uiMethodObj=new uiMethods),g_functype==FuncType.Mode_Control?(controlOBJ=new mControl(changCallback),voiceManager=(deviceInfo.lang,new voiceWidget(changCallback))):controlOBJ=new mControl,parseStates(e);try{controlOBJ.init_storage(DataObject)}catch(e){console.log("刷新页面出错："+e)}g_functype==FuncType.Mode_Control?($("#div-save").hide(),navigator.PluginInterface.sendDataToDevice(g_mac,searchJson,!1,_timeCallback),_timer=setInterval(_timerGetStates,5e3)):($("#div-save").show(),$("#center-save").click(function(){Save()}),$(".middleDiv").hide())}function changCallback(e){console.log("jsonData:"+e);try{isQuery=!1,navigator.PluginInterface.sendDataToDevice(g_mac,e,!0,callback)}catch(e){console.log("e:"+e)}}function _timerGetStates(){console.log("定时");try{console.log(),isQuery&&navigator.PluginInterface.sendDataToDevice(g_mac,searchJson,!1,_timeCallback)}catch(e){console.log("e:"+e)}}function _timeCallback(e){console.log("定时回调:"+e),parseStates(e),updateUI()}function upLockState(e){try{deviceInfo=JSON.parse(e),0==deviceInfo.lock?$("#modeLock").hide():$("#modeLock").show()}catch(e){console.log(e)}}function updateUI(){isVoiceing||controlOBJ.init_storage(DataObject)}function sendDataAndCallback(e,t){try{navigator.PluginInterface.sendDataToDevice(g_mac,e,!1,t)}catch(e){console.log(e)}}function callback(e){if(console.log("result:"+e),isQuery=!0,""==e||null==e)return void navigator.PluginInterface.sendDataToDevice(g_mac,searchJson,!1,_timeCallback);if(console.log("控制指令应答:"+e),2==JSON.parse(e).p.length)try{var t=JSON.parse(e).p;DataObject.timeLeft=parseInt(t[1]),uiMethodObj.modifyTimeByCmd(DataObject.timeLeft)}catch(e){}else if(3==JSON.parse(e).p.length)try{var t=JSON.parse(e).p;DataObject.timeLeft=parseInt(t[2]),uiMethodObj.modifyTimeByCmd(DataObject.timeLeft)}catch(e){}}function Save(){var e=getSentCenterJson(),t=getDat(),a='{"opt":["power","runState","washMode","speed","washTemp",';a+='"energySave","preWash","creaseRes","noDrain","adjustWash",',a+='"potch","nightWash","highWater","order","dryMode",',a+='"quiet"],"p":'+e+',"t":"cmd"}',console.log(a);var o=getRemarks();console.log(o),navigator.PluginInterface.getCCcmd(g_mac,a,o,t)}function getDat(){var e=[];return objForCenter=controlOBJ.getCenterParam(),e.push(objForCenter.power),e.push(objForCenter.runState),e.push(objForCenter.washMode),e.push(objForCenter.speed),e.push(objForCenter.washTemp),e.push(objForCenter.stage),e.push(objForCenter.timeLeft),e.push(objForCenter.timeAll),e.push(objForCenter.energySave),e.push(objForCenter.preWash),e.push(objForCenter.creaseRes),e.push(objForCenter.noDrain),e.push(objForCenter.adjustWash),e.push(objForCenter.potch),e.push(objForCenter.nightWash),e.push(objForCenter.highWater),e.push(objForCenter.order),e.push(objForCenter.dryMode),e.push(objForCenter.childLock),e.push(objForCenter.quiet),e.push(objForCenter.noFoam),e.push([]),e.push(objForCenter.name),JSON.stringify(e)}function getSentCenterJson(){var e=[];return objForCenter=controlOBJ.getCenterParam(),e.push(objForCenter.power),e.push(objForCenter.runState),e.push(objForCenter.washMode),e.push(objForCenter.speed),e.push(objForCenter.washTemp),e.push(objForCenter.energySave),e.push(objForCenter.preWash),e.push(objForCenter.creaseRes),e.push(objForCenter.noDrain),e.push(objForCenter.adjustWash),e.push(objForCenter.potch),e.push(objForCenter.nightWash),e.push(objForCenter.highWater),e.push(objForCenter.order),e.push(objForCenter.dryMode),e.push(objForCenter.quiet),JSON.stringify(e)}function getRemarks(){var e="";return e=0==objForCenter.power?"关机 ":"开机 ",1==objForCenter.runState?e+="暂停状态 ":e+="运行状态 ",e+=lang.modeWash[objForCenter.washMode-1]+" ",e+="转速"+objForCenter.speed+" ",e+="洗衣温度"+objForCenter.washTemp+" ",e+="..."}function updateKeyValue(e,t){updateObject(e,t),updateUI()}function updateObject(e,t){switch(e){case"power":DataObject.power=parseInt(t);break;case"runState":DataObject.runState=parseInt(t);break;case"washMode":DataObject.washMode=parseInt(t)}}function updateFromCmd(e,t){for(var a=0;a<e.opt.length;a++)updateObject(e.opt[a],e.p[a]),console.log("opt:"+e.opt[a]+" p:"+e.p[a])}function backButton(){$("#overlayAdv").hasClass("open")?($("#overlayAdv").removeClass("open"),$("#mask").hide()):$("#pagevoice").is(":hidden")?$("#overlayMode").hasClass("open")?($("#overlayMode").removeClass("open"),$("#mask").hide()):$("#overlayOrder").hasClass("open")?($("#overlayOrder").removeClass("open"),$("#mask").hide()):"继续"==$("#pauseTxt").text()&&"hidden"!=$("#runMask").css("visibility")?($("#runMask").css({visibility:"hidden"}),controlOBJ.init_storage(DataObject)):(navigator.PluginInterface.closePage(),clearInterval(_timer)):(console.log("hidden"),voiceManager.finishPage())}function onResume(){g_functype==FuncType.Mode_Control&&(console.log(_timer),0==_timer&&(_timer=setInterval(_timerGetStates,5e3)),navigator.PluginInterface.getInfo(g_mac,resumeCallBack),navigator.PluginInterface.sendDataToDevice(g_mac,searchJson,!1,_timeCallback))}function onReFocus(){console.log("onReFocus")}function resumeCallBack(e){deviceInfo=JSON.parse(e);var t=$("#mainName");void 0==deviceInfo?t.text("洗衣机"):t.text(deviceInfo.name)}var IsDebug=!1,isQuery=!0,path="",deviceInfo,g_CurrentMode,g_CurrentMode_txt,g_CurrentFan,g_CurrentFan_txt,g_CurrentPow,g_CurrentTemp=16,g_functype=0,fadeOutTime=1e3,modeManager,objForCenter={},g_CurrentLang,controlOBJ,uiMethodObj,tempManager,voiceManager,v_understand,v_common,v_extra,btnManager,mutexManager,data="",_timer,FuncType={Mode_Control:"0",Mode_Center_Control:"1"},isVoiceing=!1,mode={cotton:1,mix:2,jean:3,big:4,underclothes:5,sport:6,clean:7,potchAndDry:8,noWater:9,chemical:10,shirts:11,fast:12,weakDry:13,powerDry:14},TemUn={C:0,F:1},DataObject={power:0,runState:0,washMode:0,speed:0,washTemp:0,stage:0,timeLeft:0,timeAll:0,energySave:0,preWash:0,creaseRes:0,noDrain:0,adjustWash:0,potch:0,nightWash:0,highWater:0,order:0,dryMode:0,childLock:0,quiet:0,noFoam:0,er:[],name:""};window.addEventListener("DOMContentLoaded",parseUrlData,!1);